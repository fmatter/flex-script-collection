
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../tags/">
      
      
        <link rel="next" href="../dict_audio_path/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.5">
    
    
      
        <title>Amplify segments of speech in WAV files - Language documentation script collection</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6a10b989.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../style.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#amplify-segments-of-speech-in-wav-files" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Language documentation script collection" class="md-header__button md-logo" aria-label="Language documentation script collection" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Language documentation script collection
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Amplify segments of speech in WAV files
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/fmatter/langdoc-script-collection" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Language documentation script collection" class="md-nav__button md-logo" aria-label="Language documentation script collection" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Language documentation script collection
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/fmatter/langdoc-script-collection" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tags
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Scripts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Amplify segments of speech in WAV files
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Amplify segments of speech in WAV files
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#execution" class="md-nav__link">
    Execution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source" class="md-nav__link">
    Source
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../dict_audio_path/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add prefix to audio path (.lift)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
<nav class="md-tags" >
  
    
    
      
      
    
    
      <a href="../../tags/#audio" class="md-tag md-tag-icon">audio</a>
    
  
    
    
      
      
    
    
      <a href="../../tags/#wav" class="md-tag md-tag-icon">wav</a>
    
  
</nav>


  
  


<h1 id="amplify-segments-of-speech-in-wav-files">Amplify segments of speech in WAV files</h1>
<p>Author: Wesley Kuhron Jones</p>
<p>This script amplifies segments of a WAV audio file so that it is more audible when played on a laptop or speaker in the field during transcription sessions with language consultants. It has been optimized to use low amounts of RAM so that it can be run on small laptops like the Asus that I use in Papua New Guinea.</p>
<p>Procedure that I follow manually:</p>
<ul>
<li>find a section of audio between silent spots (or at least significantly quieter than the voice volume)</li>
<li>amplify it and go past clipping to some extent, so the average amplitude is enough to hear well</li>
<li>ignore isolated small spikes that make the max amplitude much larger than the average, I've never had a problem with clipping too much making it hard for consultants to understand, so err on the side of being too loud</li>
</ul>
<p>This script automates this procedure.</p>
<h2 id="setup">Setup</h2>
<p>Edit the variables in the area at the top of the script labeled "PARAMS TO BE SET BY USER".</p>
<p>Requirements:</p>
<div class="language-shell highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>pip<span style="color: #bbbbbb"> </span>install<span style="color: #bbbbbb"> </span>numpy<span style="color: #bbbbbb"> </span>matplotlib
</span></code></pre></div>
<h2 id="execution">Execution</h2>
<div class="language-shell highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>python<span style="color: #bbbbbb"> </span>amplify_wav.py
</span></code></pre></div>
<h2 id="source">Source</h2>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span style="color: #3D7B7B; font-style: italic"># Copyright (c) 2023 Wesley Kuhron Jones &lt;wesleykuhronjones@gmail.com&gt;</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span style="color: #3D7B7B; font-style: italic"># Licensed under the MIT License, see below</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span style="color: #3D7B7B; font-style: italic">### PARAMS TO BE SET BY USER ###</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span style="color: #3D7B7B; font-style: italic"># set `zoom` to True if the file was created directly by the Zoom H6, False for Audacity</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>zoom <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span style="color: #3D7B7B; font-style: italic"># selecting the file</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>n <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;0394&quot;</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>suffix <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Tr1&quot;</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>fp <span style="color: #666666">=</span> <span style="color: #BA2121">f&quot;Transcriptions/temp/ZOOM</span><span style="color: #A45A77; font-weight: bold">{</span>n<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">/ZOOM</span><span style="color: #A45A77; font-weight: bold">{</span>n<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">_</span><span style="color: #A45A77; font-weight: bold">{</span>suffix<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">.WAV&quot;</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span style="color: #3D7B7B; font-style: italic"># what amplitude is considered &quot;quiet&quot;, i.e., not containing speech</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>cutting_amplitude <span style="color: #666666">=</span> <span style="color: #666666">0.002</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span style="color: #3D7B7B; font-style: italic"># make a plot of the waveform, RMS, cutting points, etc. for debugging or understanding what the script is doing</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>plot <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span style="color: #3D7B7B; font-style: italic"># width of the sliding window for calculating RMS amplitude</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>window_seconds <span style="color: #666666">=</span> <span style="color: #666666">1/5</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span style="color: #3D7B7B; font-style: italic"># amplitude to amplify the audio segments to</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>target_amplitude <span style="color: #666666">=</span> <span style="color: #666666">0.25</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span style="color: #3D7B7B; font-style: italic">### END USER PARAMS ###</span>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">math</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>RATE <span style="color: #666666">=</span> <span style="color: #666666">44100</span>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>MAX_AMPLITUDE <span style="color: #666666">=</span> <span style="color: #666666">32767</span>
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_binary_string</span>(n, big_endian<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>):
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a>    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">type</span>(n) <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">int</span>, <span style="color: #008000">type</span>(n)
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #666666">0</span> <span style="color: #666666">&lt;=</span> n <span style="color: #666666">&lt;=</span> <span style="color: #666666">255</span>
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>    <span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a>        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;0&quot;</span> <span style="color: #666666">*</span> <span style="color: #666666">8</span>
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a>    p0 <span style="color: #666666">=</span> math<span style="color: #666666">.</span>floor(math<span style="color: #666666">.</span>log2(n))
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a>    y <span style="color: #666666">=</span> n <span style="color: #666666">/</span> (<span style="color: #666666">2</span> <span style="color: #666666">**</span> p0)
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>    s <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;&quot;</span>
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>    <span style="color: #008000; font-weight: bold">while</span> n <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a>        x, y <span style="color: #666666">=</span> <span style="color: #008000">divmod</span>(y, <span style="color: #666666">2</span>)
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a>        s <span style="color: #666666">+=</span> <span style="color: #008000">str</span>(<span style="color: #008000">int</span>(x))
</span><span id="__span-2-50"><a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a>        <span style="color: #008000; font-weight: bold">if</span> y <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
</span><span id="__span-2-51"><a id="__codelineno-2-51" name="__codelineno-2-51" href="#__codelineno-2-51"></a>            <span style="color: #008000; font-weight: bold">break</span>
</span><span id="__span-2-52"><a id="__codelineno-2-52" name="__codelineno-2-52" href="#__codelineno-2-52"></a>        y <span style="color: #666666">*=</span> <span style="color: #666666">2</span>
</span><span id="__span-2-53"><a id="__codelineno-2-53" name="__codelineno-2-53" href="#__codelineno-2-53"></a>    <span style="color: #008000; font-weight: bold">assert</span> s[<span style="color: #666666">0</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;0&quot;</span>
</span><span id="__span-2-54"><a id="__codelineno-2-54" name="__codelineno-2-54" href="#__codelineno-2-54"></a>    s <span style="color: #666666">=</span> s[<span style="color: #666666">1</span>:]
</span><span id="__span-2-55"><a id="__codelineno-2-55" name="__codelineno-2-55" href="#__codelineno-2-55"></a>    l <span style="color: #666666">=</span> <span style="color: #666666">1</span> <span style="color: #666666">+</span> p0
</span><span id="__span-2-56"><a id="__codelineno-2-56" name="__codelineno-2-56" href="#__codelineno-2-56"></a>    s <span style="color: #666666">=</span> s<span style="color: #666666">.</span>ljust(l, <span style="color: #BA2121">&quot;0&quot;</span>)
</span><span id="__span-2-57"><a id="__codelineno-2-57" name="__codelineno-2-57" href="#__codelineno-2-57"></a>    s <span style="color: #666666">=</span> s<span style="color: #666666">.</span>rjust(<span style="color: #666666">8</span>, <span style="color: #BA2121">&quot;0&quot;</span>)
</span><span id="__span-2-58"><a id="__codelineno-2-58" name="__codelineno-2-58" href="#__codelineno-2-58"></a>
</span><span id="__span-2-59"><a id="__codelineno-2-59" name="__codelineno-2-59" href="#__codelineno-2-59"></a>    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> big_endian:
</span><span id="__span-2-60"><a id="__codelineno-2-60" name="__codelineno-2-60" href="#__codelineno-2-60"></a>        s <span style="color: #666666">=</span> s[::<span style="color: #666666">-1</span>]
</span><span id="__span-2-61"><a id="__codelineno-2-61" name="__codelineno-2-61" href="#__codelineno-2-61"></a>    <span style="color: #3D7B7B; font-style: italic"># print(f&quot;{n} -&gt; {s}&quot;)</span>
</span><span id="__span-2-62"><a id="__codelineno-2-62" name="__codelineno-2-62" href="#__codelineno-2-62"></a>    <span style="color: #008000; font-weight: bold">return</span> s
</span><span id="__span-2-63"><a id="__codelineno-2-63" name="__codelineno-2-63" href="#__codelineno-2-63"></a>
</span><span id="__span-2-64"><a id="__codelineno-2-64" name="__codelineno-2-64" href="#__codelineno-2-64"></a>
</span><span id="__span-2-65"><a id="__codelineno-2-65" name="__codelineno-2-65" href="#__codelineno-2-65"></a><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">twos_complement</span>(b):
</span><span id="__span-2-66"><a id="__codelineno-2-66" name="__codelineno-2-66" href="#__codelineno-2-66"></a>    s <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;&quot;</span>
</span><span id="__span-2-67"><a id="__codelineno-2-67" name="__codelineno-2-67" href="#__codelineno-2-67"></a>    <span style="color: #008000; font-weight: bold">for</span> c <span style="color: #AA22FF; font-weight: bold">in</span> b:
</span><span id="__span-2-68"><a id="__codelineno-2-68" name="__codelineno-2-68" href="#__codelineno-2-68"></a>        <span style="color: #008000; font-weight: bold">if</span> c <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;0&quot;</span>:
</span><span id="__span-2-69"><a id="__codelineno-2-69" name="__codelineno-2-69" href="#__codelineno-2-69"></a>            s <span style="color: #666666">+=</span> <span style="color: #BA2121">&quot;1&quot;</span>
</span><span id="__span-2-70"><a id="__codelineno-2-70" name="__codelineno-2-70" href="#__codelineno-2-70"></a>        <span style="color: #008000; font-weight: bold">elif</span> c <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;1&quot;</span>:
</span><span id="__span-2-71"><a id="__codelineno-2-71" name="__codelineno-2-71" href="#__codelineno-2-71"></a>            s <span style="color: #666666">+=</span> <span style="color: #BA2121">&quot;0&quot;</span>
</span><span id="__span-2-72"><a id="__codelineno-2-72" name="__codelineno-2-72" href="#__codelineno-2-72"></a>        <span style="color: #008000; font-weight: bold">else</span>:
</span><span id="__span-2-73"><a id="__codelineno-2-73" name="__codelineno-2-73" href="#__codelineno-2-73"></a>            <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #CB3F38; font-weight: bold">ValueError</span>(c)
</span><span id="__span-2-74"><a id="__codelineno-2-74" name="__codelineno-2-74" href="#__codelineno-2-74"></a>    <span style="color: #008000; font-weight: bold">return</span> s
</span><span id="__span-2-75"><a id="__codelineno-2-75" name="__codelineno-2-75" href="#__codelineno-2-75"></a>
</span><span id="__span-2-76"><a id="__codelineno-2-76" name="__codelineno-2-76" href="#__codelineno-2-76"></a>
</span><span id="__span-2-77"><a id="__codelineno-2-77" name="__codelineno-2-77" href="#__codelineno-2-77"></a><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">binary_to_int</span>(b):
</span><span id="__span-2-78"><a id="__codelineno-2-78" name="__codelineno-2-78" href="#__codelineno-2-78"></a>    n <span style="color: #666666">=</span> <span style="color: #666666">0</span>
</span><span id="__span-2-79"><a id="__codelineno-2-79" name="__codelineno-2-79" href="#__codelineno-2-79"></a>    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(b)):
</span><span id="__span-2-80"><a id="__codelineno-2-80" name="__codelineno-2-80" href="#__codelineno-2-80"></a>        x <span style="color: #666666">=</span> <span style="color: #008000">int</span>(b[<span style="color: #666666">-</span>(i<span style="color: #666666">+1</span>)])
</span><span id="__span-2-81"><a id="__codelineno-2-81" name="__codelineno-2-81" href="#__codelineno-2-81"></a>        n <span style="color: #666666">+=</span> x <span style="color: #666666">*</span> (<span style="color: #666666">2</span> <span style="color: #666666">**</span> i)
</span><span id="__span-2-82"><a id="__codelineno-2-82" name="__codelineno-2-82" href="#__codelineno-2-82"></a>    <span style="color: #008000; font-weight: bold">return</span> n
</span><span id="__span-2-83"><a id="__codelineno-2-83" name="__codelineno-2-83" href="#__codelineno-2-83"></a>
</span><span id="__span-2-84"><a id="__codelineno-2-84" name="__codelineno-2-84" href="#__codelineno-2-84"></a>
</span><span id="__span-2-85"><a id="__codelineno-2-85" name="__codelineno-2-85" href="#__codelineno-2-85"></a><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_array_from_file</span>(fp, zoom):
</span><span id="__span-2-86"><a id="__codelineno-2-86" name="__codelineno-2-86" href="#__codelineno-2-86"></a>    <span style="color: #008000">print</span>(<span style="color: #BA2121">f&quot;opening </span><span style="color: #A45A77; font-weight: bold">{</span>fp<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;</span>)
</span><span id="__span-2-87"><a id="__codelineno-2-87" name="__codelineno-2-87" href="#__codelineno-2-87"></a>    <span style="color: #008000; font-weight: bold">with</span> <span style="color: #008000">open</span>(fp, <span style="color: #BA2121">&quot;rb&quot;</span>) <span style="color: #008000; font-weight: bold">as</span> f:
</span><span id="__span-2-88"><a id="__codelineno-2-88" name="__codelineno-2-88" href="#__codelineno-2-88"></a>        contents <span style="color: #666666">=</span> f<span style="color: #666666">.</span>read()
</span><span id="__span-2-89"><a id="__codelineno-2-89" name="__codelineno-2-89" href="#__codelineno-2-89"></a>
</span><span id="__span-2-90"><a id="__codelineno-2-90" name="__codelineno-2-90" href="#__codelineno-2-90"></a>    hx <span style="color: #666666">=</span> contents<span style="color: #666666">.</span>hex()
</span><span id="__span-2-91"><a id="__codelineno-2-91" name="__codelineno-2-91" href="#__codelineno-2-91"></a>    padding <span style="color: #666666">=</span> <span style="color: #666666">65536</span> <span style="color: #008000; font-weight: bold">if</span> zoom <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">22</span>  <span style="color: #3D7B7B; font-style: italic"># Audacity uses a different value for some reason</span>
</span><span id="__span-2-92"><a id="__codelineno-2-92" name="__codelineno-2-92" href="#__codelineno-2-92"></a>
</span><span id="__span-2-93"><a id="__codelineno-2-93" name="__codelineno-2-93" href="#__codelineno-2-93"></a>    samples <span style="color: #666666">=</span> <span style="color: #008000">len</span>(hx) <span style="color: #666666">/</span> <span style="color: #666666">4</span> <span style="color: #666666">-</span> padding
</span><span id="__span-2-94"><a id="__codelineno-2-94" name="__codelineno-2-94" href="#__codelineno-2-94"></a>    <span style="color: #008000; font-weight: bold">assert</span> samples <span style="color: #666666">%</span> <span style="color: #666666">1</span> <span style="color: #666666">==</span> <span style="color: #666666">0</span>, <span style="color: #BA2121">f&quot;samples should be an integer, got </span><span style="color: #A45A77; font-weight: bold">{</span>samples<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;</span>
</span><span id="__span-2-95"><a id="__codelineno-2-95" name="__codelineno-2-95" href="#__codelineno-2-95"></a>    samples <span style="color: #666666">=</span> <span style="color: #008000">int</span>(samples)
</span><span id="__span-2-96"><a id="__codelineno-2-96" name="__codelineno-2-96" href="#__codelineno-2-96"></a>
</span><span id="__span-2-97"><a id="__codelineno-2-97" name="__codelineno-2-97" href="#__codelineno-2-97"></a>    header_hex <span style="color: #666666">=</span> hx[:<span style="color: #666666">4*</span>padding]
</span><span id="__span-2-98"><a id="__codelineno-2-98" name="__codelineno-2-98" href="#__codelineno-2-98"></a>
</span><span id="__span-2-99"><a id="__codelineno-2-99" name="__codelineno-2-99" href="#__codelineno-2-99"></a>    b <span style="color: #666666">=</span> <span style="color: #008000">bytes</span><span style="color: #666666">.</span>fromhex(hx[<span style="color: #666666">4*</span>padding:])
</span><span id="__span-2-100"><a id="__codelineno-2-100" name="__codelineno-2-100" href="#__codelineno-2-100"></a>    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(b) <span style="color: #666666">==</span> <span style="color: #666666">2</span> <span style="color: #666666">*</span> samples, <span style="color: #BA2121">f&quot;</span><span style="color: #A45A77; font-weight: bold">{</span><span style="color: #008000">len</span>(b)<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> != </span><span style="color: #A45A77; font-weight: bold">{</span><span style="color: #666666">2</span><span style="color: #bbbbbb"> </span><span style="color: #666666">*</span><span style="color: #bbbbbb"> </span>samples<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;</span>
</span><span id="__span-2-101"><a id="__codelineno-2-101" name="__codelineno-2-101" href="#__codelineno-2-101"></a>
</span><span id="__span-2-102"><a id="__codelineno-2-102" name="__codelineno-2-102" href="#__codelineno-2-102"></a>    <span style="color: #3D7B7B; font-style: italic"># for testing</span>
</span><span id="__span-2-103"><a id="__codelineno-2-103" name="__codelineno-2-103" href="#__codelineno-2-103"></a>    <span style="color: #3D7B7B; font-style: italic"># good_sample_range = 1014990, 1015039  # Audacity counts from 0</span>
</span><span id="__span-2-104"><a id="__codelineno-2-104" name="__codelineno-2-104" href="#__codelineno-2-104"></a>
</span><span id="__span-2-105"><a id="__codelineno-2-105" name="__codelineno-2-105" href="#__codelineno-2-105"></a>    arr <span style="color: #666666">=</span> []
</span><span id="__span-2-106"><a id="__codelineno-2-106" name="__codelineno-2-106" href="#__codelineno-2-106"></a>    <span style="color: #3D7B7B; font-style: italic"># for i in range(*good_sample_range):</span>
</span><span id="__span-2-107"><a id="__codelineno-2-107" name="__codelineno-2-107" href="#__codelineno-2-107"></a>    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(samples):
</span><span id="__span-2-108"><a id="__codelineno-2-108" name="__codelineno-2-108" href="#__codelineno-2-108"></a>        <span style="color: #008000; font-weight: bold">if</span> i <span style="color: #666666">%</span> <span style="color: #666666">1000000</span> <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
</span><span id="__span-2-109"><a id="__codelineno-2-109" name="__codelineno-2-109" href="#__codelineno-2-109"></a>            <span style="color: #008000">print</span>(<span style="color: #BA2121">f&quot;getting array from WAV file: </span><span style="color: #A45A77; font-weight: bold">{</span>i<span style="color: #bbbbbb"> </span><span style="color: #666666">//</span><span style="color: #bbbbbb"> </span><span style="color: #666666">1000000</span><span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> / </span><span style="color: #A45A77; font-weight: bold">{</span>samples<span style="color: #bbbbbb"> </span><span style="color: #666666">/</span><span style="color: #bbbbbb"> </span><span style="color: #666666">1000000</span><span style="color: #A45A77; font-weight: bold">:</span><span style="color: #BA2121">.1f</span><span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> M&quot;</span>)
</span><span id="__span-2-110"><a id="__codelineno-2-110" name="__codelineno-2-110" href="#__codelineno-2-110"></a>        x, y <span style="color: #666666">=</span> b[<span style="color: #666666">2*</span>i : <span style="color: #666666">2*</span>i<span style="color: #666666">+2</span>]
</span><span id="__span-2-111"><a id="__codelineno-2-111" name="__codelineno-2-111" href="#__codelineno-2-111"></a>        n <span style="color: #666666">=</span> (<span style="color: #666666">2**8</span>) <span style="color: #666666">*</span> y <span style="color: #666666">+</span> x
</span><span id="__span-2-112"><a id="__codelineno-2-112" name="__codelineno-2-112" href="#__codelineno-2-112"></a>        <span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">&gt;=</span> <span style="color: #666666">2**15</span>:
</span><span id="__span-2-113"><a id="__codelineno-2-113" name="__codelineno-2-113" href="#__codelineno-2-113"></a>            <span style="color: #3D7B7B; font-style: italic"># the first bit of y is 1</span>
</span><span id="__span-2-114"><a id="__codelineno-2-114" name="__codelineno-2-114" href="#__codelineno-2-114"></a>            n <span style="color: #666666">=</span> <span style="color: #666666">-1</span> <span style="color: #666666">*</span> (<span style="color: #666666">2**16</span> <span style="color: #666666">-</span> <span style="color: #666666">1</span> <span style="color: #666666">-</span> n)
</span><span id="__span-2-115"><a id="__codelineno-2-115" name="__codelineno-2-115" href="#__codelineno-2-115"></a>        arr<span style="color: #666666">.</span>append(n)
</span><span id="__span-2-116"><a id="__codelineno-2-116" name="__codelineno-2-116" href="#__codelineno-2-116"></a>
</span><span id="__span-2-117"><a id="__codelineno-2-117" name="__codelineno-2-117" href="#__codelineno-2-117"></a>    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>array(arr) <span style="color: #666666">/</span> MAX_AMPLITUDE, header_hex
</span><span id="__span-2-118"><a id="__codelineno-2-118" name="__codelineno-2-118" href="#__codelineno-2-118"></a>
</span><span id="__span-2-119"><a id="__codelineno-2-119" name="__codelineno-2-119" href="#__codelineno-2-119"></a>
</span><span id="__span-2-120"><a id="__codelineno-2-120" name="__codelineno-2-120" href="#__codelineno-2-120"></a><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_bytes_from_int</span>(n):
</span><span id="__span-2-121"><a id="__codelineno-2-121" name="__codelineno-2-121" href="#__codelineno-2-121"></a>    <span style="color: #3D7B7B; font-style: italic"># clip to max amplitude</span>
</span><span id="__span-2-122"><a id="__codelineno-2-122" name="__codelineno-2-122" href="#__codelineno-2-122"></a>    <span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>:
</span><span id="__span-2-123"><a id="__codelineno-2-123" name="__codelineno-2-123" href="#__codelineno-2-123"></a>        n <span style="color: #666666">=</span> <span style="color: #008000">max</span>(<span style="color: #666666">-</span>MAX_AMPLITUDE, n)
</span><span id="__span-2-124"><a id="__codelineno-2-124" name="__codelineno-2-124" href="#__codelineno-2-124"></a>        y, x <span style="color: #666666">=</span> <span style="color: #008000">divmod</span>(n <span style="color: #666666">+</span> <span style="color: #666666">2**16</span> <span style="color: #666666">-</span> <span style="color: #666666">1</span>, <span style="color: #666666">2**8</span>)
</span><span id="__span-2-125"><a id="__codelineno-2-125" name="__codelineno-2-125" href="#__codelineno-2-125"></a>    <span style="color: #008000; font-weight: bold">else</span>:
</span><span id="__span-2-126"><a id="__codelineno-2-126" name="__codelineno-2-126" href="#__codelineno-2-126"></a>        n <span style="color: #666666">=</span> <span style="color: #008000">min</span>(MAX_AMPLITUDE, n)
</span><span id="__span-2-127"><a id="__codelineno-2-127" name="__codelineno-2-127" href="#__codelineno-2-127"></a>        y, x <span style="color: #666666">=</span> <span style="color: #008000">divmod</span>(n, <span style="color: #666666">2**8</span>)
</span><span id="__span-2-128"><a id="__codelineno-2-128" name="__codelineno-2-128" href="#__codelineno-2-128"></a>    <span style="color: #008000; font-weight: bold">if</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span> <span style="color: #AA22FF; font-weight: bold">or</span> x <span style="color: #666666">&gt;</span> <span style="color: #666666">255</span> <span style="color: #AA22FF; font-weight: bold">or</span> y <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span> <span style="color: #AA22FF; font-weight: bold">or</span> y <span style="color: #666666">&gt;</span> <span style="color: #666666">255</span>:
</span><span id="__span-2-129"><a id="__codelineno-2-129" name="__codelineno-2-129" href="#__codelineno-2-129"></a>        <span style="color: #008000">print</span>(n, x, y)
</span><span id="__span-2-130"><a id="__codelineno-2-130" name="__codelineno-2-130" href="#__codelineno-2-130"></a>        <span style="color: #008000; font-weight: bold">raise</span>
</span><span id="__span-2-131"><a id="__codelineno-2-131" name="__codelineno-2-131" href="#__codelineno-2-131"></a>    <span style="color: #008000; font-weight: bold">return</span> x, y  <span style="color: #3D7B7B; font-style: italic"># little-endian</span>
</span><span id="__span-2-132"><a id="__codelineno-2-132" name="__codelineno-2-132" href="#__codelineno-2-132"></a>
</span><span id="__span-2-133"><a id="__codelineno-2-133" name="__codelineno-2-133" href="#__codelineno-2-133"></a>
</span><span id="__span-2-134"><a id="__codelineno-2-134" name="__codelineno-2-134" href="#__codelineno-2-134"></a><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">rms</span>(arr):
</span><span id="__span-2-135"><a id="__codelineno-2-135" name="__codelineno-2-135" href="#__codelineno-2-135"></a>    <span style="color: #008000; font-weight: bold">return</span> (np<span style="color: #666666">.</span>mean(arr<span style="color: #666666">**2</span>))<span style="color: #666666">**0.5</span>
</span><span id="__span-2-136"><a id="__codelineno-2-136" name="__codelineno-2-136" href="#__codelineno-2-136"></a>
</span><span id="__span-2-137"><a id="__codelineno-2-137" name="__codelineno-2-137" href="#__codelineno-2-137"></a>
</span><span id="__span-2-138"><a id="__codelineno-2-138" name="__codelineno-2-138" href="#__codelineno-2-138"></a><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">sliding_rms</span>(arr, window):
</span><span id="__span-2-139"><a id="__codelineno-2-139" name="__codelineno-2-139" href="#__codelineno-2-139"></a>    b <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(<span style="color: #008000">len</span>(arr))
</span><span id="__span-2-140"><a id="__codelineno-2-140" name="__codelineno-2-140" href="#__codelineno-2-140"></a>    <span style="color: #3D7B7B; font-style: italic"># pad it with zeros for the missing frames, need window-1 of them</span>
</span><span id="__span-2-141"><a id="__codelineno-2-141" name="__codelineno-2-141" href="#__codelineno-2-141"></a>    n_in_front <span style="color: #666666">=</span> (window <span style="color: #666666">-</span> <span style="color: #666666">1</span>) <span style="color: #666666">//</span> <span style="color: #666666">2</span>
</span><span id="__span-2-142"><a id="__codelineno-2-142" name="__codelineno-2-142" href="#__codelineno-2-142"></a>    n_in_back <span style="color: #666666">=</span> (window <span style="color: #666666">-</span> <span style="color: #666666">1</span>) <span style="color: #666666">-</span> n_in_front
</span><span id="__span-2-143"><a id="__codelineno-2-143" name="__codelineno-2-143" href="#__codelineno-2-143"></a>
</span><span id="__span-2-144"><a id="__codelineno-2-144" name="__codelineno-2-144" href="#__codelineno-2-144"></a>    a2 <span style="color: #666666">=</span> arr<span style="color: #666666">**2</span>
</span><span id="__span-2-145"><a id="__codelineno-2-145" name="__codelineno-2-145" href="#__codelineno-2-145"></a>    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(arr) <span style="color: #666666">-</span> window <span style="color: #666666">+</span> <span style="color: #666666">1</span>):
</span><span id="__span-2-146"><a id="__codelineno-2-146" name="__codelineno-2-146" href="#__codelineno-2-146"></a>        <span style="color: #008000; font-weight: bold">if</span> i <span style="color: #666666">%</span> <span style="color: #666666">1000000</span> <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
</span><span id="__span-2-147"><a id="__codelineno-2-147" name="__codelineno-2-147" href="#__codelineno-2-147"></a>            <span style="color: #008000">print</span>(<span style="color: #BA2121">f&quot;getting sliding rms: </span><span style="color: #A45A77; font-weight: bold">{</span>i<span style="color: #bbbbbb"> </span><span style="color: #666666">//</span><span style="color: #bbbbbb"> </span><span style="color: #666666">1000000</span><span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> / </span><span style="color: #A45A77; font-weight: bold">{</span>(<span style="color: #008000">len</span>(arr)<span style="color: #bbbbbb"> </span><span style="color: #666666">-</span><span style="color: #bbbbbb"> </span>window<span style="color: #bbbbbb"> </span><span style="color: #666666">+</span><span style="color: #bbbbbb"> </span><span style="color: #666666">1</span>)<span style="color: #bbbbbb"> </span><span style="color: #666666">/</span><span style="color: #bbbbbb"> </span><span style="color: #666666">1000000</span><span style="color: #A45A77; font-weight: bold">:</span><span style="color: #BA2121">.1f</span><span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> M&quot;</span>)
</span><span id="__span-2-148"><a id="__codelineno-2-148" name="__codelineno-2-148" href="#__codelineno-2-148"></a>        <span style="color: #008000; font-weight: bold">if</span> i <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
</span><span id="__span-2-149"><a id="__codelineno-2-149" name="__codelineno-2-149" href="#__codelineno-2-149"></a>            window_sum <span style="color: #666666">=</span> <span style="color: #008000">sum</span>(a2[:window])
</span><span id="__span-2-150"><a id="__codelineno-2-150" name="__codelineno-2-150" href="#__codelineno-2-150"></a>        <span style="color: #008000; font-weight: bold">else</span>:
</span><span id="__span-2-151"><a id="__codelineno-2-151" name="__codelineno-2-151" href="#__codelineno-2-151"></a>            window_sum <span style="color: #666666">-=</span> a2[i <span style="color: #666666">-</span> <span style="color: #666666">1</span>]
</span><span id="__span-2-152"><a id="__codelineno-2-152" name="__codelineno-2-152" href="#__codelineno-2-152"></a>            window_sum <span style="color: #666666">+=</span> a2[i <span style="color: #666666">+</span> window <span style="color: #666666">-</span> <span style="color: #666666">1</span>]
</span><span id="__span-2-153"><a id="__codelineno-2-153" name="__codelineno-2-153" href="#__codelineno-2-153"></a>        window_mean <span style="color: #666666">=</span> window_sum <span style="color: #666666">/</span> window
</span><span id="__span-2-154"><a id="__codelineno-2-154" name="__codelineno-2-154" href="#__codelineno-2-154"></a>        window_rms <span style="color: #666666">=</span> window_mean <span style="color: #666666">**</span> <span style="color: #666666">0.5</span>
</span><span id="__span-2-155"><a id="__codelineno-2-155" name="__codelineno-2-155" href="#__codelineno-2-155"></a>        b[i <span style="color: #666666">+</span> n_in_front] <span style="color: #666666">=</span> window_rms
</span><span id="__span-2-156"><a id="__codelineno-2-156" name="__codelineno-2-156" href="#__codelineno-2-156"></a>    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>array(b)
</span><span id="__span-2-157"><a id="__codelineno-2-157" name="__codelineno-2-157" href="#__codelineno-2-157"></a>
</span><span id="__span-2-158"><a id="__codelineno-2-158" name="__codelineno-2-158" href="#__codelineno-2-158"></a>
</span><span id="__span-2-159"><a id="__codelineno-2-159" name="__codelineno-2-159" href="#__codelineno-2-159"></a><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_cuttable_intervals_from_cut_arr</span>(cut_arr):
</span><span id="__span-2-160"><a id="__codelineno-2-160" name="__codelineno-2-160" href="#__codelineno-2-160"></a>    interval_borders <span style="color: #666666">=</span> [<span style="color: #666666">-0.5</span>]
</span><span id="__span-2-161"><a id="__codelineno-2-161" name="__codelineno-2-161" href="#__codelineno-2-161"></a>    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(cut_arr) <span style="color: #666666">-</span> <span style="color: #666666">1</span>):
</span><span id="__span-2-162"><a id="__codelineno-2-162" name="__codelineno-2-162" href="#__codelineno-2-162"></a>        <span style="color: #008000; font-weight: bold">if</span> i <span style="color: #666666">%</span> <span style="color: #666666">1000000</span> <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
</span><span id="__span-2-163"><a id="__codelineno-2-163" name="__codelineno-2-163" href="#__codelineno-2-163"></a>            <span style="color: #008000">print</span>(<span style="color: #BA2121">f&quot;getting interval borders: </span><span style="color: #A45A77; font-weight: bold">{</span>i<span style="color: #bbbbbb"> </span><span style="color: #666666">//</span><span style="color: #bbbbbb"> </span><span style="color: #666666">1000000</span><span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> / </span><span style="color: #A45A77; font-weight: bold">{</span><span style="color: #008000">len</span>(cut_arr)<span style="color: #bbbbbb"> </span><span style="color: #666666">/</span><span style="color: #bbbbbb"> </span><span style="color: #666666">1000000</span><span style="color: #A45A77; font-weight: bold">:</span><span style="color: #BA2121">.1f</span><span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> M&quot;</span>)
</span><span id="__span-2-164"><a id="__codelineno-2-164" name="__codelineno-2-164" href="#__codelineno-2-164"></a>        a <span style="color: #666666">=</span> cut_arr[i]
</span><span id="__span-2-165"><a id="__codelineno-2-165" name="__codelineno-2-165" href="#__codelineno-2-165"></a>        b <span style="color: #666666">=</span> cut_arr[i<span style="color: #666666">+1</span>]
</span><span id="__span-2-166"><a id="__codelineno-2-166" name="__codelineno-2-166" href="#__codelineno-2-166"></a>        <span style="color: #008000; font-weight: bold">if</span> a <span style="color: #666666">!=</span> b:
</span><span id="__span-2-167"><a id="__codelineno-2-167" name="__codelineno-2-167" href="#__codelineno-2-167"></a>            interval_borders<span style="color: #666666">.</span>append(i<span style="color: #666666">+0.5</span>)
</span><span id="__span-2-168"><a id="__codelineno-2-168" name="__codelineno-2-168" href="#__codelineno-2-168"></a>    interval_borders<span style="color: #666666">.</span>append(<span style="color: #008000">len</span>(cut_arr) <span style="color: #666666">-</span> <span style="color: #666666">1</span> <span style="color: #666666">+</span> <span style="color: #666666">0.5</span>)
</span><span id="__span-2-169"><a id="__codelineno-2-169" name="__codelineno-2-169" href="#__codelineno-2-169"></a>
</span><span id="__span-2-170"><a id="__codelineno-2-170" name="__codelineno-2-170" href="#__codelineno-2-170"></a>    cuttable_intervals <span style="color: #666666">=</span> []
</span><span id="__span-2-171"><a id="__codelineno-2-171" name="__codelineno-2-171" href="#__codelineno-2-171"></a>    non_cuttable_intervals <span style="color: #666666">=</span> []
</span><span id="__span-2-172"><a id="__codelineno-2-172" name="__codelineno-2-172" href="#__codelineno-2-172"></a>    <span style="color: #3D7B7B; font-style: italic"># in_interval = None</span>
</span><span id="__span-2-173"><a id="__codelineno-2-173" name="__codelineno-2-173" href="#__codelineno-2-173"></a>    <span style="color: #3D7B7B; font-style: italic"># start_index = None</span>
</span><span id="__span-2-174"><a id="__codelineno-2-174" name="__codelineno-2-174" href="#__codelineno-2-174"></a>    <span style="color: #3D7B7B; font-style: italic"># last_index = None</span>
</span><span id="__span-2-175"><a id="__codelineno-2-175" name="__codelineno-2-175" href="#__codelineno-2-175"></a>    <span style="color: #008000; font-weight: bold">for</span> j_i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(interval_borders) <span style="color: #666666">-</span> <span style="color: #666666">1</span>):
</span><span id="__span-2-176"><a id="__codelineno-2-176" name="__codelineno-2-176" href="#__codelineno-2-176"></a>        j <span style="color: #666666">=</span> interval_borders[j_i]
</span><span id="__span-2-177"><a id="__codelineno-2-177" name="__codelineno-2-177" href="#__codelineno-2-177"></a>        k <span style="color: #666666">=</span> interval_borders[j_i <span style="color: #666666">+</span> <span style="color: #666666">1</span>]
</span><span id="__span-2-178"><a id="__codelineno-2-178" name="__codelineno-2-178" href="#__codelineno-2-178"></a>        <span style="color: #008000; font-weight: bold">assert</span> j <span style="color: #666666">%</span> <span style="color: #666666">1</span> <span style="color: #666666">==</span> <span style="color: #666666">0.5</span>
</span><span id="__span-2-179"><a id="__codelineno-2-179" name="__codelineno-2-179" href="#__codelineno-2-179"></a>        <span style="color: #008000; font-weight: bold">assert</span> k <span style="color: #666666">%</span> <span style="color: #666666">1</span> <span style="color: #666666">==</span> <span style="color: #666666">0.5</span>
</span><span id="__span-2-180"><a id="__codelineno-2-180" name="__codelineno-2-180" href="#__codelineno-2-180"></a>        bounds <span style="color: #666666">=</span> (<span style="color: #008000">int</span>(j<span style="color: #666666">+1</span>), <span style="color: #008000">int</span>(k))
</span><span id="__span-2-181"><a id="__codelineno-2-181" name="__codelineno-2-181" href="#__codelineno-2-181"></a>        value <span style="color: #666666">=</span> cut_arr[<span style="color: #008000">int</span>(j<span style="color: #666666">+1</span>)]
</span><span id="__span-2-182"><a id="__codelineno-2-182" name="__codelineno-2-182" href="#__codelineno-2-182"></a>        <span style="color: #008000; font-weight: bold">if</span> value <span style="color: #666666">==</span> <span style="color: #666666">1</span>:
</span><span id="__span-2-183"><a id="__codelineno-2-183" name="__codelineno-2-183" href="#__codelineno-2-183"></a>            cuttable_intervals<span style="color: #666666">.</span>append(bounds)
</span><span id="__span-2-184"><a id="__codelineno-2-184" name="__codelineno-2-184" href="#__codelineno-2-184"></a>        <span style="color: #008000; font-weight: bold">elif</span> value <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
</span><span id="__span-2-185"><a id="__codelineno-2-185" name="__codelineno-2-185" href="#__codelineno-2-185"></a>            non_cuttable_intervals<span style="color: #666666">.</span>append(bounds)
</span><span id="__span-2-186"><a id="__codelineno-2-186" name="__codelineno-2-186" href="#__codelineno-2-186"></a>        <span style="color: #008000; font-weight: bold">else</span>:
</span><span id="__span-2-187"><a id="__codelineno-2-187" name="__codelineno-2-187" href="#__codelineno-2-187"></a>            <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #CB3F38; font-weight: bold">ValueError</span>(value)
</span><span id="__span-2-188"><a id="__codelineno-2-188" name="__codelineno-2-188" href="#__codelineno-2-188"></a>        <span style="color: #3D7B7B; font-style: italic"># the new interval starts at i = j+0.5</span>
</span><span id="__span-2-189"><a id="__codelineno-2-189" name="__codelineno-2-189" href="#__codelineno-2-189"></a>
</span><span id="__span-2-190"><a id="__codelineno-2-190" name="__codelineno-2-190" href="#__codelineno-2-190"></a>    <span style="color: #3D7B7B; font-style: italic"># for i in ?:</span>
</span><span id="__span-2-191"><a id="__codelineno-2-191" name="__codelineno-2-191" href="#__codelineno-2-191"></a>        <span style="color: #3D7B7B; font-style: italic"># if x == 1 and (in_interval is None or not in_interval):</span>
</span><span id="__span-2-192"><a id="__codelineno-2-192" name="__codelineno-2-192" href="#__codelineno-2-192"></a>        <span style="color: #3D7B7B; font-style: italic">#     # found a new interval, log its start index</span>
</span><span id="__span-2-193"><a id="__codelineno-2-193" name="__codelineno-2-193" href="#__codelineno-2-193"></a>        <span style="color: #3D7B7B; font-style: italic">#     interval = (start_index, last_index)</span>
</span><span id="__span-2-194"><a id="__codelineno-2-194" name="__codelineno-2-194" href="#__codelineno-2-194"></a>        <span style="color: #3D7B7B; font-style: italic">#     if start_index is not None:</span>
</span><span id="__span-2-195"><a id="__codelineno-2-195" name="__codelineno-2-195" href="#__codelineno-2-195"></a>        <span style="color: #3D7B7B; font-style: italic">#         non_cuttable_intervals.append(interval)</span>
</span><span id="__span-2-196"><a id="__codelineno-2-196" name="__codelineno-2-196" href="#__codelineno-2-196"></a>        <span style="color: #3D7B7B; font-style: italic">#     start_index = i</span>
</span><span id="__span-2-197"><a id="__codelineno-2-197" name="__codelineno-2-197" href="#__codelineno-2-197"></a>        <span style="color: #3D7B7B; font-style: italic"># if x == 0 and (in_interval is None or in_interval):</span>
</span><span id="__span-2-198"><a id="__codelineno-2-198" name="__codelineno-2-198" href="#__codelineno-2-198"></a>        <span style="color: #3D7B7B; font-style: italic">#     # left an interval, log the last index as the end</span>
</span><span id="__span-2-199"><a id="__codelineno-2-199" name="__codelineno-2-199" href="#__codelineno-2-199"></a>        <span style="color: #3D7B7B; font-style: italic">#     interval = (start_index, last_index)</span>
</span><span id="__span-2-200"><a id="__codelineno-2-200" name="__codelineno-2-200" href="#__codelineno-2-200"></a>        <span style="color: #3D7B7B; font-style: italic">#     if start_index is not None:</span>
</span><span id="__span-2-201"><a id="__codelineno-2-201" name="__codelineno-2-201" href="#__codelineno-2-201"></a>        <span style="color: #3D7B7B; font-style: italic">#         cuttable_intervals.append(interval)</span>
</span><span id="__span-2-202"><a id="__codelineno-2-202" name="__codelineno-2-202" href="#__codelineno-2-202"></a>        <span style="color: #3D7B7B; font-style: italic">#     start_index = i</span>
</span><span id="__span-2-203"><a id="__codelineno-2-203" name="__codelineno-2-203" href="#__codelineno-2-203"></a>        <span style="color: #3D7B7B; font-style: italic"># in_interval = x == 1</span>
</span><span id="__span-2-204"><a id="__codelineno-2-204" name="__codelineno-2-204" href="#__codelineno-2-204"></a>        <span style="color: #3D7B7B; font-style: italic"># last_index = i</span>
</span><span id="__span-2-205"><a id="__codelineno-2-205" name="__codelineno-2-205" href="#__codelineno-2-205"></a>    <span style="color: #3D7B7B; font-style: italic"># if we finish and we&#39;re still in an interval, log it</span>
</span><span id="__span-2-206"><a id="__codelineno-2-206" name="__codelineno-2-206" href="#__codelineno-2-206"></a>    <span style="color: #3D7B7B; font-style: italic"># if in_interval:</span>
</span><span id="__span-2-207"><a id="__codelineno-2-207" name="__codelineno-2-207" href="#__codelineno-2-207"></a>    <span style="color: #3D7B7B; font-style: italic">#     interval = (start_index, last_index)</span>
</span><span id="__span-2-208"><a id="__codelineno-2-208" name="__codelineno-2-208" href="#__codelineno-2-208"></a>    <span style="color: #3D7B7B; font-style: italic">#     cuttable_intervals.append(interval)</span>
</span><span id="__span-2-209"><a id="__codelineno-2-209" name="__codelineno-2-209" href="#__codelineno-2-209"></a>    <span style="color: #008000; font-weight: bold">return</span> cuttable_intervals, non_cuttable_intervals
</span><span id="__span-2-210"><a id="__codelineno-2-210" name="__codelineno-2-210" href="#__codelineno-2-210"></a>
</span><span id="__span-2-211"><a id="__codelineno-2-211" name="__codelineno-2-211" href="#__codelineno-2-211"></a>
</span><span id="__span-2-212"><a id="__codelineno-2-212" name="__codelineno-2-212" href="#__codelineno-2-212"></a><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_cutting_points</span>(rms_arr, cutting_amplitude):
</span><span id="__span-2-213"><a id="__codelineno-2-213" name="__codelineno-2-213" href="#__codelineno-2-213"></a>    cut_arr <span style="color: #666666">=</span> rms_arr <span style="color: #666666">&lt;</span> cutting_amplitude
</span><span id="__span-2-214"><a id="__codelineno-2-214" name="__codelineno-2-214" href="#__codelineno-2-214"></a>    cuttable_intervals, sound_intervals <span style="color: #666666">=</span> get_cuttable_intervals_from_cut_arr(cut_arr)
</span><span id="__span-2-215"><a id="__codelineno-2-215" name="__codelineno-2-215" href="#__codelineno-2-215"></a>
</span><span id="__span-2-216"><a id="__codelineno-2-216" name="__codelineno-2-216" href="#__codelineno-2-216"></a>    <span style="color: #3D7B7B; font-style: italic"># also want average amplitude within each non-quiet interval</span>
</span><span id="__span-2-217"><a id="__codelineno-2-217" name="__codelineno-2-217" href="#__codelineno-2-217"></a>    average_amplitudes <span style="color: #666666">=</span> [np<span style="color: #666666">.</span>mean(rms_arr[a : b<span style="color: #666666">+1</span>]) <span style="color: #008000; font-weight: bold">for</span> a, b <span style="color: #AA22FF; font-weight: bold">in</span> sound_intervals]
</span><span id="__span-2-218"><a id="__codelineno-2-218" name="__codelineno-2-218" href="#__codelineno-2-218"></a>
</span><span id="__span-2-219"><a id="__codelineno-2-219" name="__codelineno-2-219" href="#__codelineno-2-219"></a>    <span style="color: #3D7B7B; font-style: italic"># start - 0.5 and end + 0.5 should always be cutting points, even if they&#39;re inside an interval</span>
</span><span id="__span-2-220"><a id="__codelineno-2-220" name="__codelineno-2-220" href="#__codelineno-2-220"></a>    start_cut <span style="color: #666666">=</span> <span style="color: #666666">-0.5</span>
</span><span id="__span-2-221"><a id="__codelineno-2-221" name="__codelineno-2-221" href="#__codelineno-2-221"></a>    end_cut <span style="color: #666666">=</span> <span style="color: #008000">len</span>(rms_arr) <span style="color: #666666">-</span> <span style="color: #666666">1</span> <span style="color: #666666">+</span> <span style="color: #666666">0.5</span>
</span><span id="__span-2-222"><a id="__codelineno-2-222" name="__codelineno-2-222" href="#__codelineno-2-222"></a>    <span style="color: #3D7B7B; font-style: italic"># if we have cuttable intervals that overlap the start or end, ignore them</span>
</span><span id="__span-2-223"><a id="__codelineno-2-223" name="__codelineno-2-223" href="#__codelineno-2-223"></a>    <span style="color: #008000; font-weight: bold">if</span> cuttable_intervals[<span style="color: #666666">0</span>][<span style="color: #666666">0</span>] <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
</span><span id="__span-2-224"><a id="__codelineno-2-224" name="__codelineno-2-224" href="#__codelineno-2-224"></a>        cuttable_intervals<span style="color: #666666">.</span>remove(cuttable_intervals[<span style="color: #666666">0</span>])
</span><span id="__span-2-225"><a id="__codelineno-2-225" name="__codelineno-2-225" href="#__codelineno-2-225"></a>    <span style="color: #008000; font-weight: bold">if</span> cuttable_intervals[<span style="color: #666666">-1</span>][<span style="color: #666666">-1</span>] <span style="color: #666666">==</span> <span style="color: #008000">len</span>(rms_arr) <span style="color: #666666">-</span> <span style="color: #666666">1</span>:
</span><span id="__span-2-226"><a id="__codelineno-2-226" name="__codelineno-2-226" href="#__codelineno-2-226"></a>        cuttable_intervals<span style="color: #666666">.</span>remove(cuttable_intervals[<span style="color: #666666">-1</span>])
</span><span id="__span-2-227"><a id="__codelineno-2-227" name="__codelineno-2-227" href="#__codelineno-2-227"></a>    <span style="color: #3D7B7B; font-style: italic"># for all the other ones, put the middle plus 0.5</span>
</span><span id="__span-2-228"><a id="__codelineno-2-228" name="__codelineno-2-228" href="#__codelineno-2-228"></a>    cutting_points <span style="color: #666666">=</span> [<span style="color: #666666">0.5</span> <span style="color: #666666">+</span> <span style="color: #008000">int</span>((a <span style="color: #666666">+</span> b)<span style="color: #666666">/2</span>) <span style="color: #008000; font-weight: bold">for</span> a, b <span style="color: #AA22FF; font-weight: bold">in</span> cuttable_intervals]
</span><span id="__span-2-229"><a id="__codelineno-2-229" name="__codelineno-2-229" href="#__codelineno-2-229"></a>    cutting_points <span style="color: #666666">=</span> [start_cut] <span style="color: #666666">+</span> cutting_points <span style="color: #666666">+</span> [end_cut]
</span><span id="__span-2-230"><a id="__codelineno-2-230" name="__codelineno-2-230" href="#__codelineno-2-230"></a>
</span><span id="__span-2-231"><a id="__codelineno-2-231" name="__codelineno-2-231" href="#__codelineno-2-231"></a>    <span style="color: #008000; font-weight: bold">return</span> cutting_points, sound_intervals, average_amplitudes
</span><span id="__span-2-232"><a id="__codelineno-2-232" name="__codelineno-2-232" href="#__codelineno-2-232"></a>
</span><span id="__span-2-233"><a id="__codelineno-2-233" name="__codelineno-2-233" href="#__codelineno-2-233"></a>
</span><span id="__span-2-234"><a id="__codelineno-2-234" name="__codelineno-2-234" href="#__codelineno-2-234"></a>
</span><span id="__span-2-235"><a id="__codelineno-2-235" name="__codelineno-2-235" href="#__codelineno-2-235"></a><span style="color: #008000; font-weight: bold">if</span> <span style="color: #19177C">__name__</span> <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;__main__&quot;</span>:
</span><span id="__span-2-236"><a id="__codelineno-2-236" name="__codelineno-2-236" href="#__codelineno-2-236"></a>    window_samples <span style="color: #666666">=</span> <span style="color: #008000">int</span>(RATE <span style="color: #666666">*</span> window_seconds)
</span><span id="__span-2-237"><a id="__codelineno-2-237" name="__codelineno-2-237" href="#__codelineno-2-237"></a>    arr, header_hex <span style="color: #666666">=</span> get_array_from_file(fp, zoom)
</span><span id="__span-2-238"><a id="__codelineno-2-238" name="__codelineno-2-238" href="#__codelineno-2-238"></a>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;getting sliding rms&quot;</span>)
</span><span id="__span-2-239"><a id="__codelineno-2-239" name="__codelineno-2-239" href="#__codelineno-2-239"></a>    rms_arr <span style="color: #666666">=</span> sliding_rms(arr, window_samples)
</span><span id="__span-2-240"><a id="__codelineno-2-240" name="__codelineno-2-240" href="#__codelineno-2-240"></a>    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(arr) <span style="color: #666666">==</span> <span style="color: #008000">len</span>(rms_arr)
</span><span id="__span-2-241"><a id="__codelineno-2-241" name="__codelineno-2-241" href="#__codelineno-2-241"></a>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;done getting sliding rms&quot;</span>)
</span><span id="__span-2-242"><a id="__codelineno-2-242" name="__codelineno-2-242" href="#__codelineno-2-242"></a>
</span><span id="__span-2-243"><a id="__codelineno-2-243" name="__codelineno-2-243" href="#__codelineno-2-243"></a>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;getting cutting points&quot;</span>)
</span><span id="__span-2-244"><a id="__codelineno-2-244" name="__codelineno-2-244" href="#__codelineno-2-244"></a>    cutting_points, sound_intervals, average_amplitudes <span style="color: #666666">=</span> get_cutting_points(rms_arr, cutting_amplitude)
</span><span id="__span-2-245"><a id="__codelineno-2-245" name="__codelineno-2-245" href="#__codelineno-2-245"></a>    sound_interval_lengths <span style="color: #666666">=</span> [(b <span style="color: #666666">-</span> a <span style="color: #666666">+</span> <span style="color: #666666">1</span>) <span style="color: #666666">/</span> RATE <span style="color: #008000; font-weight: bold">for</span> a, b <span style="color: #AA22FF; font-weight: bold">in</span> sound_intervals]
</span><span id="__span-2-246"><a id="__codelineno-2-246" name="__codelineno-2-246" href="#__codelineno-2-246"></a>    asil <span style="color: #666666">=</span> <span style="color: #008000">sum</span>(sound_interval_lengths) <span style="color: #666666">/</span> <span style="color: #008000">len</span>(sound_interval_lengths)
</span><span id="__span-2-247"><a id="__codelineno-2-247" name="__codelineno-2-247" href="#__codelineno-2-247"></a>    <span style="color: #008000">print</span>(<span style="color: #BA2121">f&quot;average sound interval length: </span><span style="color: #A45A77; font-weight: bold">{</span>asil<span style="color: #A45A77; font-weight: bold">:</span><span style="color: #BA2121">.4f</span><span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> seconds&quot;</span>)
</span><span id="__span-2-248"><a id="__codelineno-2-248" name="__codelineno-2-248" href="#__codelineno-2-248"></a>    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> plot:
</span><span id="__span-2-249"><a id="__codelineno-2-249" name="__codelineno-2-249" href="#__codelineno-2-249"></a>        <span style="color: #008000; font-weight: bold">del</span> rms_arr
</span><span id="__span-2-250"><a id="__codelineno-2-250" name="__codelineno-2-250" href="#__codelineno-2-250"></a>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;done getting cutting points&quot;</span>)
</span><span id="__span-2-251"><a id="__codelineno-2-251" name="__codelineno-2-251" href="#__codelineno-2-251"></a>
</span><span id="__span-2-252"><a id="__codelineno-2-252" name="__codelineno-2-252" href="#__codelineno-2-252"></a>    <span style="color: #3D7B7B; font-style: italic"># put the average in each interval at some value</span>
</span><span id="__span-2-253"><a id="__codelineno-2-253" name="__codelineno-2-253" href="#__codelineno-2-253"></a>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;making new_arr&quot;</span>)
</span><span id="__span-2-254"><a id="__codelineno-2-254" name="__codelineno-2-254" href="#__codelineno-2-254"></a>    new_arr <span style="color: #666666">=</span> arr
</span><span id="__span-2-255"><a id="__codelineno-2-255" name="__codelineno-2-255" href="#__codelineno-2-255"></a>    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(sound_intervals)):
</span><span id="__span-2-256"><a id="__codelineno-2-256" name="__codelineno-2-256" href="#__codelineno-2-256"></a>        cut_a, cut_b <span style="color: #666666">=</span> cutting_points[i:i<span style="color: #666666">+2</span>]
</span><span id="__span-2-257"><a id="__codelineno-2-257" name="__codelineno-2-257" href="#__codelineno-2-257"></a>        amp <span style="color: #666666">=</span> average_amplitudes[i]
</span><span id="__span-2-258"><a id="__codelineno-2-258" name="__codelineno-2-258" href="#__codelineno-2-258"></a>        r <span style="color: #666666">=</span> target_amplitude <span style="color: #666666">/</span> amp
</span><span id="__span-2-259"><a id="__codelineno-2-259" name="__codelineno-2-259" href="#__codelineno-2-259"></a>        new_arr[<span style="color: #008000">int</span>(cut_a <span style="color: #666666">+</span> <span style="color: #666666">1</span>) : <span style="color: #008000">int</span>(cut_b <span style="color: #666666">+</span> <span style="color: #666666">1</span>)] <span style="color: #666666">*=</span> r
</span><span id="__span-2-260"><a id="__codelineno-2-260" name="__codelineno-2-260" href="#__codelineno-2-260"></a>    new_arr_int <span style="color: #666666">=</span> (new_arr <span style="color: #666666">*</span> <span style="color: #666666">2**15</span>)<span style="color: #666666">.</span>astype(<span style="color: #008000">int</span>)
</span><span id="__span-2-261"><a id="__codelineno-2-261" name="__codelineno-2-261" href="#__codelineno-2-261"></a>    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> plot:
</span><span id="__span-2-262"><a id="__codelineno-2-262" name="__codelineno-2-262" href="#__codelineno-2-262"></a>        <span style="color: #008000; font-weight: bold">del</span> new_arr
</span><span id="__span-2-263"><a id="__codelineno-2-263" name="__codelineno-2-263" href="#__codelineno-2-263"></a>        <span style="color: #008000; font-weight: bold">del</span> arr
</span><span id="__span-2-264"><a id="__codelineno-2-264" name="__codelineno-2-264" href="#__codelineno-2-264"></a>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;done making new_arr&quot;</span>)
</span><span id="__span-2-265"><a id="__codelineno-2-265" name="__codelineno-2-265" href="#__codelineno-2-265"></a>
</span><span id="__span-2-266"><a id="__codelineno-2-266" name="__codelineno-2-266" href="#__codelineno-2-266"></a>    <span style="color: #008000; font-weight: bold">if</span> plot:
</span><span id="__span-2-267"><a id="__codelineno-2-267" name="__codelineno-2-267" href="#__codelineno-2-267"></a>        <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;making plots&quot;</span>)
</span><span id="__span-2-268"><a id="__codelineno-2-268" name="__codelineno-2-268" href="#__codelineno-2-268"></a>        plt<span style="color: #666666">.</span>subplot(<span style="color: #666666">3</span>,<span style="color: #666666">1</span>,<span style="color: #666666">1</span>)
</span><span id="__span-2-269"><a id="__codelineno-2-269" name="__codelineno-2-269" href="#__codelineno-2-269"></a>        plt<span style="color: #666666">.</span>plot(arr)
</span><span id="__span-2-270"><a id="__codelineno-2-270" name="__codelineno-2-270" href="#__codelineno-2-270"></a>
</span><span id="__span-2-271"><a id="__codelineno-2-271" name="__codelineno-2-271" href="#__codelineno-2-271"></a>        plt<span style="color: #666666">.</span>subplot(<span style="color: #666666">3</span>,<span style="color: #666666">1</span>,<span style="color: #666666">2</span>)
</span><span id="__span-2-272"><a id="__codelineno-2-272" name="__codelineno-2-272" href="#__codelineno-2-272"></a>        plt<span style="color: #666666">.</span>plot(rms_arr)
</span><span id="__span-2-273"><a id="__codelineno-2-273" name="__codelineno-2-273" href="#__codelineno-2-273"></a>        <span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> cutting_points:
</span><span id="__span-2-274"><a id="__codelineno-2-274" name="__codelineno-2-274" href="#__codelineno-2-274"></a>            plt<span style="color: #666666">.</span>plot([x, x], [<span style="color: #666666">0</span>, <span style="color: #008000">max</span>(rms_arr)], c<span style="color: #666666">=</span><span style="color: #BA2121">&quot;r&quot;</span>)
</span><span id="__span-2-275"><a id="__codelineno-2-275" name="__codelineno-2-275" href="#__codelineno-2-275"></a>        <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(sound_intervals)):
</span><span id="__span-2-276"><a id="__codelineno-2-276" name="__codelineno-2-276" href="#__codelineno-2-276"></a>            a, b <span style="color: #666666">=</span> sound_intervals[i]
</span><span id="__span-2-277"><a id="__codelineno-2-277" name="__codelineno-2-277" href="#__codelineno-2-277"></a>            y <span style="color: #666666">=</span> average_amplitudes[i]
</span><span id="__span-2-278"><a id="__codelineno-2-278" name="__codelineno-2-278" href="#__codelineno-2-278"></a>            plt<span style="color: #666666">.</span>plot([a, b], [y, y], c<span style="color: #666666">=</span><span style="color: #BA2121">&quot;k&quot;</span>)
</span><span id="__span-2-279"><a id="__codelineno-2-279" name="__codelineno-2-279" href="#__codelineno-2-279"></a>
</span><span id="__span-2-280"><a id="__codelineno-2-280" name="__codelineno-2-280" href="#__codelineno-2-280"></a>        plt<span style="color: #666666">.</span>subplot(<span style="color: #666666">3</span>,<span style="color: #666666">1</span>,<span style="color: #666666">3</span>)
</span><span id="__span-2-281"><a id="__codelineno-2-281" name="__codelineno-2-281" href="#__codelineno-2-281"></a>        plt<span style="color: #666666">.</span>plot(new_arr)
</span><span id="__span-2-282"><a id="__codelineno-2-282" name="__codelineno-2-282" href="#__codelineno-2-282"></a>        <span style="color: #008000; font-weight: bold">for</span> y <span style="color: #AA22FF; font-weight: bold">in</span> [<span style="color: #666666">1</span>, <span style="color: #666666">-1</span>]:
</span><span id="__span-2-283"><a id="__codelineno-2-283" name="__codelineno-2-283" href="#__codelineno-2-283"></a>            plt<span style="color: #666666">.</span>plot([<span style="color: #666666">0</span>, <span style="color: #008000">len</span>(rms_arr) <span style="color: #666666">-</span> <span style="color: #666666">1</span>], [y, y], c<span style="color: #666666">=</span><span style="color: #BA2121">&quot;k&quot;</span>)
</span><span id="__span-2-284"><a id="__codelineno-2-284" name="__codelineno-2-284" href="#__codelineno-2-284"></a>
</span><span id="__span-2-285"><a id="__codelineno-2-285" name="__codelineno-2-285" href="#__codelineno-2-285"></a>        plt<span style="color: #666666">.</span>gcf()<span style="color: #666666">.</span>set_size_inches((<span style="color: #666666">12</span>, <span style="color: #666666">6</span>))
</span><span id="__span-2-286"><a id="__codelineno-2-286" name="__codelineno-2-286" href="#__codelineno-2-286"></a>        plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&quot;a.png&quot;</span>)
</span><span id="__span-2-287"><a id="__codelineno-2-287" name="__codelineno-2-287" href="#__codelineno-2-287"></a>
</span><span id="__span-2-288"><a id="__codelineno-2-288" name="__codelineno-2-288" href="#__codelineno-2-288"></a>        <span style="color: #008000; font-weight: bold">del</span> arr
</span><span id="__span-2-289"><a id="__codelineno-2-289" name="__codelineno-2-289" href="#__codelineno-2-289"></a>        <span style="color: #008000; font-weight: bold">del</span> new_arr
</span><span id="__span-2-290"><a id="__codelineno-2-290" name="__codelineno-2-290" href="#__codelineno-2-290"></a>        <span style="color: #008000; font-weight: bold">del</span> rms_arr
</span><span id="__span-2-291"><a id="__codelineno-2-291" name="__codelineno-2-291" href="#__codelineno-2-291"></a>
</span><span id="__span-2-292"><a id="__codelineno-2-292" name="__codelineno-2-292" href="#__codelineno-2-292"></a>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;making bytes&quot;</span>)
</span><span id="__span-2-293"><a id="__codelineno-2-293" name="__codelineno-2-293" href="#__codelineno-2-293"></a>    b <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(<span style="color: #666666">2</span> <span style="color: #666666">*</span> <span style="color: #008000">len</span>(new_arr_int), dtype<span style="color: #666666">=</span><span style="color: #008000">int</span>)
</span><span id="__span-2-294"><a id="__codelineno-2-294" name="__codelineno-2-294" href="#__codelineno-2-294"></a>    <span style="color: #008000; font-weight: bold">for</span> i, n <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">enumerate</span>(new_arr_int):
</span><span id="__span-2-295"><a id="__codelineno-2-295" name="__codelineno-2-295" href="#__codelineno-2-295"></a>        <span style="color: #008000; font-weight: bold">if</span> i <span style="color: #666666">%</span> <span style="color: #666666">1000000</span> <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
</span><span id="__span-2-296"><a id="__codelineno-2-296" name="__codelineno-2-296" href="#__codelineno-2-296"></a>            <span style="color: #008000">print</span>(<span style="color: #BA2121">f&quot;making bytes: </span><span style="color: #A45A77; font-weight: bold">{</span>i<span style="color: #bbbbbb"> </span><span style="color: #666666">//</span><span style="color: #bbbbbb"> </span><span style="color: #666666">1000000</span><span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> / </span><span style="color: #A45A77; font-weight: bold">{</span><span style="color: #008000">len</span>(new_arr_int)<span style="color: #bbbbbb"> </span><span style="color: #666666">/</span><span style="color: #bbbbbb"> </span><span style="color: #666666">1000000</span><span style="color: #A45A77; font-weight: bold">:</span><span style="color: #BA2121">.1f</span><span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> M&quot;</span>)
</span><span id="__span-2-297"><a id="__codelineno-2-297" name="__codelineno-2-297" href="#__codelineno-2-297"></a>        x, y <span style="color: #666666">=</span> get_bytes_from_int(n)
</span><span id="__span-2-298"><a id="__codelineno-2-298" name="__codelineno-2-298" href="#__codelineno-2-298"></a>        b[<span style="color: #666666">2*</span>i] <span style="color: #666666">=</span> x
</span><span id="__span-2-299"><a id="__codelineno-2-299" name="__codelineno-2-299" href="#__codelineno-2-299"></a>        b[<span style="color: #666666">2*</span>i <span style="color: #666666">+</span> <span style="color: #666666">1</span>] <span style="color: #666666">=</span> y
</span><span id="__span-2-300"><a id="__codelineno-2-300" name="__codelineno-2-300" href="#__codelineno-2-300"></a>        <span style="color: #3D7B7B; font-style: italic"># print(n, x, y, b[max(0, 2*i - 4) : min(2*len(new_arr_int), 2*i + 5)])</span>
</span><span id="__span-2-301"><a id="__codelineno-2-301" name="__codelineno-2-301" href="#__codelineno-2-301"></a>    <span style="color: #3D7B7B; font-style: italic"># b = []</span>
</span><span id="__span-2-302"><a id="__codelineno-2-302" name="__codelineno-2-302" href="#__codelineno-2-302"></a>    <span style="color: #3D7B7B; font-style: italic"># for n in new_arr_int:</span>
</span><span id="__span-2-303"><a id="__codelineno-2-303" name="__codelineno-2-303" href="#__codelineno-2-303"></a>    <span style="color: #3D7B7B; font-style: italic">#     b += list(get_bytes_from_int(n))</span>
</span><span id="__span-2-304"><a id="__codelineno-2-304" name="__codelineno-2-304" href="#__codelineno-2-304"></a>    <span style="color: #3D7B7B; font-style: italic"># b = np.array(</span>
</span><span id="__span-2-305"><a id="__codelineno-2-305" name="__codelineno-2-305" href="#__codelineno-2-305"></a>
</span><span id="__span-2-306"><a id="__codelineno-2-306" name="__codelineno-2-306" href="#__codelineno-2-306"></a>    <span style="color: #008000; font-weight: bold">assert</span> b<span style="color: #666666">.</span>min() <span style="color: #666666">&gt;=</span> <span style="color: #666666">0</span> <span style="color: #AA22FF; font-weight: bold">and</span> b<span style="color: #666666">.</span>max() <span style="color: #666666">&lt;=</span> <span style="color: #666666">255</span>
</span><span id="__span-2-307"><a id="__codelineno-2-307" name="__codelineno-2-307" href="#__codelineno-2-307"></a>    b <span style="color: #666666">=</span> <span style="color: #008000">bytes</span><span style="color: #666666">.</span>fromhex(header_hex) <span style="color: #666666">+</span> <span style="color: #008000">bytes</span>(x <span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> b)  <span style="color: #3D7B7B; font-style: italic"># don&#39;t cast np array to bytes, it messes the result up somehow</span>
</span><span id="__span-2-308"><a id="__codelineno-2-308" name="__codelineno-2-308" href="#__codelineno-2-308"></a>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;done making bytes&quot;</span>)
</span><span id="__span-2-309"><a id="__codelineno-2-309" name="__codelineno-2-309" href="#__codelineno-2-309"></a>    output_fp <span style="color: #666666">=</span> fp<span style="color: #666666">.</span>replace(<span style="color: #BA2121">&quot;.&quot;</span>, <span style="color: #BA2121">&quot;_Amplified.&quot;</span>)
</span><span id="__span-2-310"><a id="__codelineno-2-310" name="__codelineno-2-310" href="#__codelineno-2-310"></a>    <span style="color: #008000">print</span>(<span style="color: #BA2121">f&quot;writing to </span><span style="color: #A45A77; font-weight: bold">{</span>output_fp<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;</span>)
</span><span id="__span-2-311"><a id="__codelineno-2-311" name="__codelineno-2-311" href="#__codelineno-2-311"></a>    <span style="color: #008000; font-weight: bold">with</span> <span style="color: #008000">open</span>(output_fp, <span style="color: #BA2121">&quot;wb&quot;</span>) <span style="color: #008000; font-weight: bold">as</span> f:
</span><span id="__span-2-312"><a id="__codelineno-2-312" name="__codelineno-2-312" href="#__codelineno-2-312"></a>        f<span style="color: #666666">.</span>write(b)
</span><span id="__span-2-313"><a id="__codelineno-2-313" name="__codelineno-2-313" href="#__codelineno-2-313"></a>
</span><span id="__span-2-314"><a id="__codelineno-2-314" name="__codelineno-2-314" href="#__codelineno-2-314"></a>
</span><span id="__span-2-315"><a id="__codelineno-2-315" name="__codelineno-2-315" href="#__codelineno-2-315"></a><span style="color: #3D7B7B; font-style: italic"># Permission is hereby granted, free of charge, to any person obtaining a copy</span>
</span><span id="__span-2-316"><a id="__codelineno-2-316" name="__codelineno-2-316" href="#__codelineno-2-316"></a><span style="color: #3D7B7B; font-style: italic"># of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
</span><span id="__span-2-317"><a id="__codelineno-2-317" name="__codelineno-2-317" href="#__codelineno-2-317"></a><span style="color: #3D7B7B; font-style: italic"># in the Software without restriction, including without limitation the rights</span>
</span><span id="__span-2-318"><a id="__codelineno-2-318" name="__codelineno-2-318" href="#__codelineno-2-318"></a><span style="color: #3D7B7B; font-style: italic"># to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
</span><span id="__span-2-319"><a id="__codelineno-2-319" name="__codelineno-2-319" href="#__codelineno-2-319"></a><span style="color: #3D7B7B; font-style: italic"># copies of the Software, and to permit persons to whom the Software is</span>
</span><span id="__span-2-320"><a id="__codelineno-2-320" name="__codelineno-2-320" href="#__codelineno-2-320"></a><span style="color: #3D7B7B; font-style: italic"># furnished to do so, subject to the following conditions:</span>
</span><span id="__span-2-321"><a id="__codelineno-2-321" name="__codelineno-2-321" href="#__codelineno-2-321"></a>
</span><span id="__span-2-322"><a id="__codelineno-2-322" name="__codelineno-2-322" href="#__codelineno-2-322"></a><span style="color: #3D7B7B; font-style: italic"># The above copyright notice and this permission notice shall be included in all</span>
</span><span id="__span-2-323"><a id="__codelineno-2-323" name="__codelineno-2-323" href="#__codelineno-2-323"></a><span style="color: #3D7B7B; font-style: italic"># copies or substantial portions of the Software.</span>
</span><span id="__span-2-324"><a id="__codelineno-2-324" name="__codelineno-2-324" href="#__codelineno-2-324"></a>
</span><span id="__span-2-325"><a id="__codelineno-2-325" name="__codelineno-2-325" href="#__codelineno-2-325"></a><span style="color: #3D7B7B; font-style: italic"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
</span><span id="__span-2-326"><a id="__codelineno-2-326" name="__codelineno-2-326" href="#__codelineno-2-326"></a><span style="color: #3D7B7B; font-style: italic"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
</span><span id="__span-2-327"><a id="__codelineno-2-327" name="__codelineno-2-327" href="#__codelineno-2-327"></a><span style="color: #3D7B7B; font-style: italic"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
</span><span id="__span-2-328"><a id="__codelineno-2-328" name="__codelineno-2-328" href="#__codelineno-2-328"></a><span style="color: #3D7B7B; font-style: italic"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
</span><span id="__span-2-329"><a id="__codelineno-2-329" name="__codelineno-2-329" href="#__codelineno-2-329"></a><span style="color: #3D7B7B; font-style: italic"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
</span><span id="__span-2-330"><a id="__codelineno-2-330" name="__codelineno-2-330" href="#__codelineno-2-330"></a><span style="color: #3D7B7B; font-style: italic"># OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
</span><span id="__span-2-331"><a id="__codelineno-2-331" name="__codelineno-2-331" href="#__codelineno-2-331"></a><span style="color: #3D7B7B; font-style: italic"># SOFTWARE.</span>
</span></code></pre></div>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 10, 2023</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.sections", "toc.follow", "toc.integrate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "tags": {"flex": "SIL\u0027s [FieldWorks](https://software.sil.org/fieldworks/)"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
    
  </body>
</html>